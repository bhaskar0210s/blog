<!DOCTYPE html>
<html lang="en">
  <head>
    <script>
      // Prevent theme flicker by applying theme immediately
      (function () {
        try {
          const storedTheme = localStorage.getItem("theme") || "auto";
          const html = document.documentElement;

          // Apply theme immediately
          html.setAttribute("data-theme", storedTheme);

          // For auto theme, check system preference
          if (storedTheme === "auto") {
            const prefersDark = window.matchMedia(
              "(prefers-color-scheme: dark)"
            ).matches;
            if (prefersDark) {
              html.classList.add("auto-dark");
              html.classList.remove("auto-light");
            } else {
              html.classList.add("auto-light");
              html.classList.remove("auto-dark");
            }
          }

          // Update meta theme-color
          const colors = {
            light: "#ffffff",
            dark: "#1a1a1a",
            auto: window.matchMedia("(prefers-color-scheme: dark)").matches
              ? "#1a1a1a"
              : "#ffffff",
          };

          let metaThemeColor = document.querySelector(
            'meta[name="theme-color"]'
          );
          if (metaThemeColor) {
            metaThemeColor.content = colors[storedTheme] || colors.auto;
          }
        } catch (e) {
          // Fallback to light theme if localStorage fails
          document.documentElement.setAttribute("data-theme", "light");
        }
      })();
    </script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      {% if page.title %}{{ page.title }} - {% endif %}{{ site.title }}
    </title>
    <meta
      name="description"
      content="{% if page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}"
    />
    <meta name="theme-color" content="#ffffff" />
    <link
      rel="stylesheet"
      href="{{ '/assets/css/main.css' | relative_url }}"
    />
    <link rel="canonical" href="{{ page.url | absolute_url }}" />
    <link
      rel="alternate"
      type="application/rss+xml"
      title="{{ site.title }}"
      href="{{ '/feed.xml' | relative_url }}"
    />
    <script src="{{ '/assets/js/theme.js' | relative_url }}" defer></script>
  </head>
  <body>
    <header class="site-header">
      <div class="container">
        <nav class="site-nav">
          <a href="{{ '/' | relative_url }}" class="site-title"
            >{{ site.title }}</a
          >
          <ul class="nav-links">
            <li><a href="{{ '/' | relative_url }}">Home</a></li>
            <li><a href="{{ '/posts.html' | relative_url }}">Posts</a></li>
            <li>
              <a href="https://bhaskar0210s.github.io/me/" target="_blank"
                >About</a
              >
            </li>
          </ul>
        </nav>
      </div>
    </header>

    <main class="main-content">
      <div class="container">{{ content }}</div>
    </main>

    <footer class="site-footer">
      <div class="container">
        <p>
          &copy; {{ 'now' | date: "%Y" }} {{ site.author }}. All rights
          reserved.
        </p>
      </div>
    </footer>
  </body>
</html>
